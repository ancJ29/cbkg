import{r as b,u as q,R as v,f as J,j as se,D as Ie,B as k,l as te,H as He,n as V,o as Se,b as Ae,J as ke,k as T,I as Ee,K as Be,c as Je,g as pe,a as he,M as Ke,m as fe,G as K,t as r,C as Pe,F as ae,w as Qe,x as Y}from"./index-db117989.js";import{E as Re,a as Ge,u as Xe,A as Ye,C as Ze}from"./useToggleEditModal-19687ec9.js";import{u as z}from"./useTranslation-d9fa93c2.js";import{c as Ce,B as Fe,M as es}from"./index-71492496.js";import{S as ss}from"./index-4fa6584e.js";import{a as $e,u as re,c as ts,e as Me,C as ne,T as y,B as Ve}from"./Card-23a5932e.js";import{a as Te}from"./get-sorted-breakpoints-8714c725.js";import{S as as}from"./index-28f715c5.js";import{u as rs,T as X}from"./index-83819ef0.js";import{a as qe,M as ns}from"./Modal-27160204.js";import{u as ze}from"./use-form-b89b14d2.js";import{u as oe,S as le,F as ie}from"./Stack-0cc441d2.js";import{C as os}from"./CheckIcon-ad231d07.js";import{I as ls,a as is,C as ge}from"./Checkbox-e6b24ad8.js";import{P as xe}from"./index-1b7222f8.js";import{G as cs}from"./Group-29bf32ec.js";import{S as be}from"./index-4ee7a327.js";import"./Collapse-ccc789cf.js";import"./CloseButton-9718e38f.js";import"./ActionIcon-397f6903.js";function D(e){return typeof e=="object"&&e!==null?"base"in e?e.base:void 0:e}function ds(e=[]){const[s,t]=b.useState(e);return[s,{setState:t,append:(...m)=>t(p=>[...p,...m]),prepend:(...m)=>t(p=>[...m,...p]),insert:(m,...p)=>t(x=>[...x.slice(0,m),...p,...x.slice(m)]),pop:()=>t(m=>{const p=[...m];return p.pop(),p}),shift:()=>t(m=>{const p=[...m];return p.shift(),p}),apply:m=>t(p=>p.map((x,N)=>m(x,N))),applyWhere:(m,p)=>t(x=>x.map((N,w)=>m(N,w)?p(N,w):N)),remove:(...m)=>t(p=>p.filter((x,N)=>!m.includes(N))),reorder:({from:m,to:p})=>t(x=>{const N=[...x],w=x[m];return N.splice(m,1),N.splice(p,0,w),N}),setItem:(m,p)=>t(x=>{const N=[...x];return N[m]=p,N}),setItemProp:(m,p,x)=>t(N=>{const w=[...N];return w[m]={...w[m],[p]:x},w}),filter:m=>{t(p=>p.filter(m))}}]}const[us,ms]=$e(),ps={};function We(e){const{value:s,defaultValue:t,onChange:n,multiple:o,children:i}=q("ChipGroup",ps,e),[l,a]=oe({value:s,defaultValue:t,finalValue:o?[]:null,onChange:n}),c=h=>Array.isArray(l)?l.includes(h):h===l,u=h=>{const d=h.currentTarget.value;Array.isArray(l)?a(l.includes(d)?l.filter(g=>g!==d):[...l,d]):a(d)};return v.createElement(us,{value:{isChipSelected:c,onChange:u,multiple:o}},i)}We.displayName="@mantine/core/ChipGroup";var Oe={root:"m-f59ffda3",label:"m-be049a53","label--outline":"m-3904c1af","label--filled":"m-fa109255","label--light":"m-f7e165c3",iconWrapper:"m-9ac86df9",checkIcon:"m-d6d72580",input:"m-bde07329"};const hs={type:"checkbox"},fs=te((e,{size:s,radius:t,variant:n,color:o})=>{const i=e.variantColorResolver({color:o||e.primaryColor,theme:e,variant:n||"filled"});return{root:{"--chip-fz":He(s),"--chip-size":V(s,"chip-size"),"--chip-radius":t===void 0?void 0:Se(t),"--chip-checked-padding":V(s,"chip-checked-padding"),"--chip-padding":V(s,"chip-padding"),"--chip-icon-size":V(s,"chip-icon-size"),"--chip-bg":o||n?i.background:void 0,"--chip-hover":o||n?i.hover:void 0,"--chip-color":o||n?i.color:void 0,"--chip-bd":o||n?i.border:void 0,"--chip-spacing":V(s,"chip-spacing")}}}),Z=J((e,s)=>{const t=q("Chip",hs,e),{classNames:n,className:o,style:i,styles:l,unstyled:a,vars:c,id:u,checked:h,defaultChecked:d,onChange:g,value:f,wrapperProps:C,type:m,disabled:p,children:x,size:N,variant:w,icon:B,rootRef:M,...Q}=t,I=se({name:"Chip",classes:Oe,props:t,className:o,style:i,classNames:n,styles:l,unstyled:a,vars:c,varsResolver:fs}),E=ms(),P=re(u),{styleProps:S,rest:W}=Ie(Q),[O,L]=oe({value:h,defaultValue:d,finalValue:!1,onChange:g}),F=E?{checked:E.isChipSelected(f),onChange:j=>{E.onChange(j),g==null||g(j.currentTarget.checked)},type:E.multiple?"checkbox":"radio"}:{},R=F.checked||O;return v.createElement(k,{size:N,variant:w,ref:M,...I("root"),...S,...C},v.createElement("input",{type:m,...I("input"),checked:R,onChange:j=>L(j.currentTarget.checked),id:P,disabled:p,ref:s,value:f,...F,...W}),v.createElement("label",{htmlFor:P,"data-checked":R||void 0,"data-disabled":p||void 0,...I("label",{variant:w||"filled"})},R&&v.createElement("span",{...I("iconWrapper")},B||v.createElement(os,{...I("checkIcon")})),x))});Z.classes=Oe;Z.displayName="@mantine/core/Chip";Z.Group=We;const[Cs,Le]=ts("Grid component was not found in tree"),ee=(e,s)=>e==="content"?"auto":e==="auto"?"0rem":e?`${100/(s/e)}%`:void 0,ve=(e,s,t)=>t||e==="auto"?"100%":e==="content"?"unset":ee(e,s),Ne=(e,s)=>{if(e)return e==="auto"||s?"1":"auto"},je=(e,s)=>e===0?"0":e?`${100/(s/e)}%`:void 0;function gs({span:e,order:s,offset:t,selector:n}){var g;const o=Ae(),i=Le(),a=D(e)===void 0?12:D(e),c=ke({"--col-order":(g=D(s))==null?void 0:g.toString(),"--col-flex-grow":Ne(a,i.grow),"--col-flex-basis":ee(a,i.columns),"--col-width":a==="content"?"auto":void 0,"--col-max-width":ve(a,i.columns,i.grow),"--col-offset":je(D(t),i.columns)}),u=T(o.breakpoints).reduce((f,C)=>{var m;return f[C]||(f[C]={}),typeof s=="object"&&s[C]!==void 0&&(f[C]["--col-order"]=(m=s[C])==null?void 0:m.toString()),typeof e=="object"&&e[C]!==void 0&&(f[C]["--col-flex-grow"]=Ne(e[C],i.grow),f[C]["--col-flex-basis"]=ee(e[C],i.columns),f[C]["--col-width"]=e[C]==="content"?"auto":void 0,f[C]["--col-max-width"]=ve(e[C],i.columns,i.grow)),typeof t=="object"&&t[C]!==void 0&&(f[C]["--col-offset"]=je(t[C],i.columns)),f},{}),d=Te(T(u),o).filter(f=>T(u[f.value]).length>0).map(f=>({query:`(min-width: ${o.breakpoints[f.value]})`,styles:u[f.value]}));return v.createElement(Ee,{styles:c,media:d,selector:n})}var ce={root:"m-410352e9",inner:"m-dee7bd2f",col:"m-96bdd299"};const xs={span:12},de=J((e,s)=>{const t=q("GridCol",xs,e),{classNames:n,className:o,style:i,styles:l,vars:a,span:c,order:u,offset:h,...d}=t,g=Le(),f=Be();return v.createElement(v.Fragment,null,v.createElement(gs,{selector:`.${f}`,span:c,order:u,offset:h}),v.createElement(k,{ref:s,...g.getStyles("col",{className:Je(o,f),style:i,classNames:n,styles:l}),...d}))});de.classes=ce;de.displayName="@mantine/core/GridCol";function bs({gutter:e,selector:s}){const t=Ae(),n=ke({"--grid-gutter":pe(D(e))}),o=T(t.breakpoints).reduce((a,c)=>(a[c]||(a[c]={}),typeof e=="object"&&e[c]!==void 0&&(a[c]["--grid-gutter"]=pe(e[c])),a),{}),l=Te(T(o),t).filter(a=>T(o[a.value]).length>0).map(a=>({query:`(min-width: ${t.breakpoints[a.value]})`,styles:o[a.value]}));return v.createElement(Ee,{styles:n,media:l,selector:s})}const vs={gutter:"md",grow:!1,columns:12},Ns=te((e,{justify:s,align:t,overflow:n})=>({root:{"--grid-justify":s,"--grid-align":t,"--grid-overflow":n}})),G=J((e,s)=>{const t=q("Grid",vs,e),{classNames:n,className:o,style:i,styles:l,unstyled:a,vars:c,grow:u,gutter:h,columns:d,align:g,justify:f,children:C,...m}=t,p=se({name:"Grid",classes:ce,props:t,className:o,style:i,classNames:n,styles:l,unstyled:a,vars:c,varsResolver:Ns}),x=Be();return v.createElement(Cs,{value:{getStyles:p,grow:u,columns:d}},v.createElement(bs,{selector:`.${x}`,...t}),v.createElement(k,{ref:s,...p("root",{className:x}),...m},v.createElement("div",{...p("inner")},C)))});G.classes=ce;G.displayName="@mantine/core/Grid";G.Col=de;const[js,ys]=$e(),ws={},ue=J((e,s)=>{const{value:t,defaultValue:n,onChange:o,size:i,wrapperProps:l,children:a,name:c,...u}=q("RadioGroup",ws,e),h=re(c),[d,g]=oe({value:t,defaultValue:n,finalValue:"",onChange:o}),f=C=>g(C.currentTarget.value);return v.createElement(js,{value:{value:d,onChange:f,size:i,name:h}},v.createElement(Me.Wrapper,{size:i,ref:s,...l,...u,labelElement:"div",__staticSelector:"RadioGroup"},v.createElement(ls,{role:"radiogroup"},a)))});ue.classes=Me.Wrapper.classes;ue.displayName="@mantine/core/RadioGroup";function _s({size:e,style:s,...t}){return v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 5 5",style:{width:he(e),height:he(e),...s},"aria-hidden":!0,...t},v.createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",fill:"currentColor"}))}var Ue={root:"m-f3f1af94",inner:"m-89c4f5e4",icon:"m-f3ed6b2b",radio:"m-8a3dbb89","radio--outline":"m-1bfe9d39"};const Is={labelPosition:"right"},Ss=te((e,{size:s,radius:t,color:n,iconColor:o,variant:i})=>{const l=Ke({color:n||e.primaryColor,theme:e}),a=l.isThemeColor&&l.shade===void 0?`var(--mantine-color-${l.color}-outline)`:l.color;return{root:{"--radio-size":V(s,"radio-size"),"--radio-radius":t===void 0?void 0:Se(t),"--radio-color":i==="outline"?a:fe(n,e),"--radio-icon-color":o?fe(o,e):void 0,"--radio-icon-size":V(s,"radio-icon-size")}}}),H=J((e,s)=>{const t=q("Radio",Is,e),{classNames:n,className:o,style:i,styles:l,unstyled:a,vars:c,id:u,size:h,label:d,labelPosition:g,description:f,error:C,radius:m,color:p,variant:x,disabled:N,wrapperProps:w,icon:B=_s,rootRef:M,iconColor:Q,onChange:I,...E}=t,P=se({name:"Radio",classes:Ue,props:t,className:o,style:i,classNames:n,styles:l,unstyled:a,vars:c,varsResolver:Ss}),S=ys(),W=(S==null?void 0:S.size)??h,O=t.size?h:W,{styleProps:L,rest:F}=Ie(E),R=re(u),j=S?{checked:S.value===F.value,name:F.name??S.name,onChange:A=>{S.onChange(A),I==null||I(A)}}:{};return v.createElement(is,{...P("root"),__staticSelector:"Radio",__stylesApiProps:t,id:R,size:O,labelPosition:g,label:d,description:f,error:C,disabled:N,classNames:n,styles:l,unstyled:a,"data-checked":j.checked||void 0,variant:x,ref:M,...L,...w},v.createElement(k,{...P("inner"),mod:{"label-position":g}},v.createElement(k,{...P("radio",{focusable:!0,variant:x}),onChange:I,...F,...j,component:"input",mod:{error:!!C},ref:s,id:R,disabled:N,type:"radio"}),v.createElement(B,{...P("icon"),"aria-hidden":!0})))});H.classes=Ue;H.displayName="@mantine/core/Radio";H.Group=ue;const ye={ADMIN:["CHAIN_MANAGER","MANAGER","STAFF"],OWNER:["CHAIN_MANAGER","MANAGER","STAFF"],CHAIN_MANAGER:["MANAGER","STAFF"],MANAGER:["STAFF"],STAFF:[]},As=e=>{if(!e||!ye[e].length)throw K.error("Invalid role provided."),new Error("Invalid role provided.");return ye[e].map(s=>({value:s,label:s}))},ks="_tableWrapper_pmbmq_1",Es="_header_pmbmq_5",Bs="_row_pmbmq_17",Ps="_label_pmbmq_27",Rs="_cell_pmbmq_31",Gs="_container_pmbmq_39",$={tableWrapper:ks,header:Es,row:Bs,label:Ps,cell:Rs,container:Gs},Fs=({headers:e,dataLength:s,rows:t,hasMore:n,handleScroll:o,headerClassName:i,tableWrapperClassName:l,haveAction:a=!0})=>{const c=z();return r.jsx(r.Fragment,{children:r.jsxs(ne,{className:Ce($.tableWrapper,l),p:0,radius:8,mt:20,w:"100%",shadow:"none",children:[r.jsx(Fe,{children:r.jsxs(G,{className:Ce($.header,i),children:[e==null?void 0:e.map(({label:u,gridCol:h},d)=>r.jsx(G.Col,{span:h||1,children:c(u)},d)),a&&r.jsx(G.Col,{span:1,children:" "})]})}),r.jsx(ss,{dataLength:s,hasMore:n,handleScroll:o,rows:t})]})})};function $s({records:e,_rowBuilder:s,t,actionBuilder:n}){return e==null?void 0:e.map((o,i)=>r.jsxs(k,{className:$.row,children:[r.jsxs(es,{children:[s(o).map(({label:l,style:a,value:c},u)=>r.jsxs(k,{className:$.cell,style:a,children:[r.jsx(y,{className:$.label,children:t(l||"")}),c]},u)),n&&r.jsxs(k,{className:$.cell,children:[r.jsx(y,{className:$.label}),n(o)]})]}),r.jsx(Fe,{children:r.jsxs(G,{children:[s(o).map(({gridCol:l,value:a},c)=>r.jsx(G.Col,{span:l||1,className:$.cell,children:a},c)),n&&r.jsx(G.Col,{span:1,children:n(o)})]},i)})]},i))}const Ms="_chainContainer_g9q37_1",Vs="_inputContainer_g9q37_7",Ts="_input_g9q37_7",qs="_radioContainer_g9q37_19",zs="_btn_g9q37_48",Ws="_classNameBox_g9q37_51",U={chainContainer:Ms,inputContainer:Vs,input:Ts,radioContainer:qs,btn:zs,classNameBox:Ws},Os=({account:e,onSave:s,onFinish:t})=>{const n=z(),[o,i]=b.useState(),[l,{close:a,open:c}]=qe(!1),u=ze({initialValues:e,transformValues:Ls,validate:{userName:g=>g.length<1?n("Please enter Username"):null}});rs(o,()=>{!o&&u.reset()});const h=b.useCallback(()=>{u.validate(),u.isValid()&&c()},[u,c]),d=b.useCallback(async()=>{if(s){i(void 0);const g=await s(u.values);g?g&&i(g):(u.reset(),t&&t())}},[u,t,s]);return r.jsx(r.Fragment,{children:r.jsxs("form",{onSubmit:u.onSubmit(c),children:[r.jsxs(le,{gap:20,px:10,my:20,children:[r.jsxs("div",{className:U.inputContainer,children:[r.jsxs(y,{children:[n("Username"),":"]}),r.jsx(X,{className:U.input,withAsterisk:!0,placeholder:n("Username"),...u.getInputProps("userName")})]}),r.jsxs("div",{className:U.inputContainer,children:[r.jsxs(y,{children:[n("FullName"),":"]}),r.jsx(X,{className:U.input,withAsterisk:!0,placeholder:n("FullName"),...u.getInputProps("fullName")})]})]}),r.jsxs(ie,{gap:12,w:"100%",pb:12,pt:28,justify:"center",direction:"column",children:[r.jsx(Pe,{children:r.jsx(Ve,{type:"submit",className:U.btn,onClick:h,children:n("Edit User")})}),r.jsx(Re,{message:o})]}),r.jsx(Ge,{title:n("Confirm"),description:n("Are you sure you want to update this account?"),open:l,onClose:a,onSave:d})]})})};function Ls(e){var s;return{...e,userName:e.userName.toString().trim(),fullName:(s=e.fullName)==null?void 0:s.toString().trim()}}const Us=({accounts:e,updateAccount:s,disableAccount:t})=>{const n=z(),{defaultChainId:o,defaultBranchId:i}=ae(),[l,a]=b.useState({branchId:i,chainId:o}),{close:c,opened:u,record:h,toggleEditModal:d}=Xe(),g=b.useMemo(()=>Ds(e,l,t,d,n),[e,l,t,d,n]),f=b.useMemo(De,[]);return r.jsxs(ne,{withBorder:!0,shadow:"md",w:"100%",children:[r.jsx(y,{fz:16,fw:"bold",pb:5,className:"bdr-b",children:n("Account list")}),r.jsx(as,{filter:l,setFilter:a}),r.jsx(Fs,{dataLength:(e==null?void 0:e.length)||0,headers:f,rows:g}),r.jsxs(ns,{opened:u,onClose:c,title:n("Edit Account"),centered:!0,size:"lg",classNames:{title:"font-bold"},children:[r.jsx("div",{className:"bdr-t"}),h&&r.jsx(Os,{account:h,onSave:s,onFinish:c})]})]})};function De(e,s){var t,n,o,i;return[{gridCol:1.5,label:"Account",value:e?r.jsxs(y,{children:[" ",e.userName||"-"]}):""},{gridCol:1.5,label:"FullName",value:e?r.jsxs(y,{children:[" ",e.fullName||"-"]}):""},{gridCol:2.5,label:"Chains",value:e?r.jsxs(y,{children:[" ",((n=(t=e.chains)==null?void 0:t[0])==null?void 0:n.name)||"-"]}):""},{gridCol:2,label:"Branches",value:e?r.jsxs(y,{children:[" ",((i=(o=e.branches)==null?void 0:o[0])==null?void 0:i.shortName)||"-"]}):""},{gridCol:2,label:"Role",value:e?r.jsxs(y,{children:[" ",(s==null?void 0:s(e.role||""))||"-"]}):""},{gridCol:1.5,label:"Status",value:r.jsx(Z,{checked:e==null?void 0:e.active,classNames:{label:"cursor-initial"},children:e!=null&&e.active?"Active":"Disable"})}]}function Ds(e,s,t,n,o){var l;const i=((l=s.keyword)==null?void 0:l.toLocaleLowerCase())||"";return $s({records:e==null?void 0:e.filter(a=>Hs(a,s,i)),t:o,_rowBuilder:De,actionBuilder:a=>r.jsx(Ye,{disable:!a.active,title:o&&o("Confirm"),description:`${o&&o("Delete account")} "${a.fullName}"`,onDelete:()=>t(a.id||""),onEdit:()=>n(a)})})}function Hs(e,s,t){var n,o,i,l,a,c,u;return s.active!==void 0&&e.active!==s.active||s.chainId&&((o=(n=e.chains)==null?void 0:n[0])==null?void 0:o.id)!==s.chainId||s.branchId&&((l=(i=e.chains)==null?void 0:i[0])==null?void 0:l.id)!==s.branchId?!1:t?!!((c=(a=e.fullName)==null?void 0:a.toLocaleLowerCase())!=null&&c.includes(t)||(u=e.userName.toLocaleLowerCase())!=null&&u.includes(t)):!0}const Js=({multiple:e=!1,options:s,handlers:t})=>{const n=s.every(l=>l.checked),o=s.some(l=>l.checked)&&!n,i=s.map((l,a)=>r.jsx(ge,{label:l.label,checked:l.checked,onChange:c=>t.setItemProp(a,"checked",c.currentTarget.checked)},l.key));return r.jsxs(ie,{direction:"column",gap:10,children:[e&&s.length>1&&r.jsx(ge,{checked:n,indeterminate:o,label:"All",onChange:()=>t.setState(l=>l.map(a=>({...a,checked:!n})))}),i]})},Ks="_label_127n5_1",we={label:Ks},Qs=({withAsterisk:e=!1,options:s,description:t,label:n,value:o,onChange:i,classNameBox:l})=>{const a=z();return r.jsx(H.Group,{withAsterisk:e,value:o,label:n,description:t&&a(t),onChange:c=>{i&&i(c)},classNames:{label:we.label},children:r.jsx(cs,{className:l,mt:"xs",children:s.map(({label:c,value:u},h)=>r.jsx(H,{label:c,value:u,classNames:{label:we.label}},h))})})},Xs="_chainContainer_g9q37_1",Ys="_inputContainer_g9q37_7",Zs="_input_g9q37_7",et="_radioContainer_g9q37_19",st="_btn_g9q37_48",tt="_classNameBox_g9q37_51",_={chainContainer:Xs,inputContainer:Ys,input:Zs,radioContainer:et,btn:st,classNameBox:tt},at={id:"",userName:"",fullName:"",password:"",rePassword:"",role:"STAFF",active:!0,branchIds:[],chainIds:[]},rt=({onSave:e})=>{var R;const s=z(),{defaultChainId:t,defaultBranchId:n,branches:o,chainOptions:i,branchOptionsByChainId:l}=ae(),a=ze({initialValues:{...at,chainIds:t?[t]:[],branchIds:n?[n]:[]},transformValues:ot,validate:nt()}),[c,u]=b.useState(""),[h,d]=b.useState(((R=a.values.chainIds)==null?void 0:R[0])||""),[g,f]=b.useState(),{user:C}=Qe(),[m,{close:p,open:x}]=qe(!1),[N,w]=b.useState([]),[B,M]=ds(_e(o,h||"")),[Q,I]=b.useMemo(()=>[i.length>0,B.length>0],[B,i]),E=b.useMemo(()=>a.values.role==="STAFF",[a.values.role]),P=b.useMemo(()=>I&&a.values.role!=="CHAIN_MANAGER",[I,a.values.role]),S=b.useCallback(j=>{const A=_e(o,j||"");M.setState(A)},[o,M]),W=b.useCallback(j=>{var me;d(j||""),S(j||"");const A=l[j||""]||[];w(A),A.length===1&&u(((me=A[0])==null?void 0:me.value.toString())||"")},[S,l]),O=b.useCallback(j=>{u(j||"")},[]),L=b.useCallback(()=>{a.validate(),a.isValid()&&x()},[a,x]),F=b.useCallback(async()=>{if(e){f(void 0),E?a.values.branchIds=[c]:a.values.branchIds=B.filter(A=>A.checked).map(A=>A.key);const j=await e(a.values);j?j&&f(j):a.reset()}},[B,c,a,E,e]);return r.jsx(r.Fragment,{children:r.jsxs("form",{onSubmit:a.onSubmit(x),children:[r.jsxs(le,{gap:20,px:10,my:20,children:[r.jsxs("div",{className:_.inputContainer,children:[r.jsxs(y,{children:[s("Username"),":"]}),r.jsx(X,{className:_.input,withAsterisk:!0,placeholder:s("Username"),...a.getInputProps("userName")})]}),r.jsxs("div",{className:_.inputContainer,children:[r.jsxs(y,{children:[s("FullName"),":"]}),r.jsx(X,{className:_.input,withAsterisk:!0,placeholder:s("FullName"),...a.getInputProps("fullName")})]}),r.jsxs("div",{className:_.inputContainer,children:[r.jsxs(y,{children:[s("Password"),":"]}),r.jsx(xe,{withAsterisk:!0,className:_.input,placeholder:s("Password"),...a.getInputProps("password")})]}),r.jsxs("div",{className:_.inputContainer,children:[r.jsxs(y,{children:[s("Re password"),":"]}),r.jsx(xe,{className:_.input,withAsterisk:!0,placeholder:s("Re password"),...a.getInputProps("rePassword")})]}),r.jsxs("div",{className:_.radioContainer,children:[r.jsx(y,{children:s("Roles:")}),r.jsx(Qs,{classNameBox:_.classNameBox,options:As((C==null?void 0:C.role)||void 0),value:a.values.role,onChange:j=>a.setFieldValue("role",j)})]})]}),r.jsxs(k,{bg:"gray.1",children:[Q&&r.jsxs(k,{className:_.inputContainer,p:10,children:[r.jsxs(y,{children:[s("Select chains"),":"]}),r.jsx(be,{placeholder:s("Select chains"),options:i,value:h||null,onChange:W,className:_.input})]}),P&&r.jsxs(k,{className:_.inputContainer,p:10,children:[r.jsxs(y,{children:[s("Select branches"),":"]}),E?r.jsx(be,{placeholder:s("Select branch"),options:N,value:c||null,onChange:O,className:_.input}):r.jsx(Js,{multiple:!0,options:B,handlers:M})]})]}),r.jsxs(ie,{gap:12,w:"100%",pb:12,pt:28,justify:"center",direction:"column",children:[r.jsx(Pe,{children:r.jsx(Ve,{disabled:!a.isValid(),type:"submit",className:_.btn,onClick:L,children:s("Create")})}),r.jsx(Re,{message:g})]}),r.jsx(Ge,{title:s("Confirm"),description:s("Are you sure you want to create this account?"),open:m,onClose:p,onSave:F})]})})};function nt(){return{userName:e=>!e,fullName:e=>!e,password:e=>!e,rePassword:(e,s)=>!e&&s.password!==e,chains:e=>!e}}function ot(e){return{id:e.id.trim(),userName:e.userName.toString().trim(),fullName:e.fullName.toString().trim(),password:e.password.toString().trim(),rePassword:e.rePassword.toString().trim(),role:e.role,active:e.active,branchIds:e.branchIds,chainIds:e.chainIds}}function _e(e,s){const t=e.filter(n=>n.chainId===s);return t.map(({id:n,name:o})=>({key:n,checked:t.length===1,label:o}))}const lt=({addAccount:e})=>{const s=z();return r.jsx(ne,{withBorder:!0,shadow:"md",w:"100%",style:{overflow:"visible"},children:r.jsx(Ze,{title:s("Create account"),children:r.jsx(rt,{onSave:e})})})};async function it(e,s,t){K.debug("fetchUsers",e,s);const n=await Y({action:"get-users",params:{take:e,cursor:s},options:{forceReload:t||!1}});if(!n)return{users:[],cursor:""};const{chainsById:o,branchesById:i}=ae.getState();return{users:(n.users||[]).map(a=>{var c,u,h;return a.chainIds&&(a.chains=(a.chainIds||[]).map(d=>o[d]?o[d]:null).filter(Boolean)),a.branchIds&&(a.branches=(a.branchIds||[]).map(d=>i[d]?i[d]:null).filter(Boolean),(c=a.chains)!=null&&c.length||(a.chains=(a.branches||[]).map(d=>d!=null&&d.chainId&&o[d==null?void 0:d.chainId]?o[d==null?void 0:d.chainId]:null).filter(Boolean))),a.chainIds=((u=a.chains)==null?void 0:u.map(d=>d.id))||[],a.branchIds=((h=a.branches)==null?void 0:h.map(d=>d.id))||[],a}),cursor:(n==null?void 0:n.cursor)||""}}const Rt=()=>{const[e,s]=b.useState([]),t=b.useCallback((l=!1)=>{ct(l).then(s)},[]);b.useEffect(()=>{t()},[t]);const n=b.useCallback(async l=>dt(l,t),[t]),o=b.useCallback(async l=>ut(l,t),[t]),i=b.useCallback(async l=>mt(l,t),[t]);return r.jsxs(le,{gap:10,bg:"gray.1",w:"100%",h:"100%",p:10,children:[r.jsx(lt,{addAccount:n}),r.jsx(Us,{accounts:e,updateAccount:o,disableAccount:i})]})};async function ct(e=!1){const s=await it(100,"",e);return(s==null?void 0:s.users)||[]}async function dt(e,s){return await Y({action:"add-user",params:e}).catch(()=>{K.error("Failed to add user",e)}),s(!0),""}async function ut(e,s){return await Y({action:"edit-user",params:e}).catch(()=>{K.error("Failed to update user",e)}),s(!0),""}async function mt(e,s){return await Y({action:"disable-users",params:{ids:[e]}}).catch(()=>{K.error("Failed to add user",e)}),s(!0),""}export{Rt as default};
