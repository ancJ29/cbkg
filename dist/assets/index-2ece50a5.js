import{F as k,r as m,t as s,B as I,C as F,x as v,G as y}from"./index-db117989.js";import{C as U,E as $,a as M,u as q,A as J}from"./useToggleEditModal-19687ec9.js";import{P as T}from"./index-94ada444.js";import{S as D}from"./index-4ee7a327.js";import{T as C}from"./index-83819ef0.js";import{u as b}from"./useFormValid-8971a46e.js";import{u as A}from"./useTranslation-d9fa93c2.js";import{i as L,c as W,f as K}from"./phone-number-949134fe.js";import{a as O,M as Q}from"./Modal-27160204.js";import{u as R}from"./use-form-b89b14d2.js";import{C as z,T as o,B as G}from"./Card-23a5932e.js";import{S as E}from"./Stack-0cc441d2.js";import{T as X}from"./index-a90a0539.js";import{S as Y}from"./index-28f715c5.js";import{c as Z}from"./index-71492496.js";import"./Group-29bf32ec.js";import"./Collapse-ccc789cf.js";import"./CloseButton-9718e38f.js";import"./CheckIcon-ad231d07.js";import"./index-4fa6584e.js";const ee="_inputContainer_r8mgx_1",se="_input_r8mgx_1",te="_classNameBox_r8mgx_6",ae="_radioContainer_r8mgx_13",ne="_btn_r8mgx_41",x={inputContainer:ee,input:se,classNameBox:te,radioContainer:ae,btn:ne},ie={id:"",name:"",shortName:"",address:"",phone:"",email:"",chainId:""},re=({addBranch:e})=>{const t=A(),{defaultChainId:a,chainOptions:n}=k(),[l,{close:u,open:r}]=O(!1),[p,N]=m.useState(""),i=R({initialValues:{...ie,chainId:a},transformValues:oe}),d=m.useCallback(h=>({name:h.name?null:t("Please enter name"),address:h.address?null:t("Please enter address"),phone:L(i.values.phone)?null:t("Please enter phone"),email:h.email?null:t("Please enter email"),chainId:h.chainId?null:t("Please select chain")}),[i.values,t]),g=b(i,d),_=m.useCallback(async h=>{N(void 0);const c=await e(h);c?N(c):i.reset()},[e,i]);return s.jsx(z,{withBorder:!0,shadow:"md",w:"100%",style:{overflow:"visible"},children:s.jsx(U,{title:t("Create branch"),children:s.jsxs("form",{onSubmit:i.onSubmit(r),children:[s.jsxs(E,{gap:10,px:10,mt:10,children:[s.jsxs("div",{className:x.inputContainer,children:[s.jsxs(o,{children:[t("Name"),":"]}),s.jsx(C,{className:x.input,withAsterisk:!0,placeholder:t("Name"),...i.getInputProps("name")})]}),s.jsxs("div",{className:x.inputContainer,children:[s.jsxs(o,{children:[t("Short Name"),":"]}),s.jsx(C,{className:x.input,withAsterisk:!0,placeholder:t("Short Name"),...i.getInputProps("shortName")})]}),s.jsxs("div",{className:x.inputContainer,children:[s.jsxs(o,{children:[t("Phone Number"),":"]}),s.jsx(T,{className:x.input,placeholder:t("Phone Number"),value:i.values.phone,onChangeValue:h=>i.setFieldValue("phone",h)})]}),s.jsxs("div",{className:x.inputContainer,children:[s.jsxs(o,{children:[t("Email"),":"]}),s.jsx(C,{className:x.input,withAsterisk:!0,placeholder:t("Email"),...i.getInputProps("email")})]}),s.jsxs("div",{className:x.inputContainer,children:[s.jsxs(o,{children:[t("Address"),":"]}),s.jsx(C,{className:x.input,withAsterisk:!0,placeholder:t("Address"),...i.getInputProps("address")})]}),s.jsxs(I,{className:x.inputContainer,children:[s.jsxs(o,{children:[t("Select chains"),":"]}),s.jsx(D,{placeholder:t("Select chains"),options:n,className:x.input,value:i.values.chainId,onChange:h=>i.setValues({chainId:h})})]}),s.jsx("div",{className:x.inputContainer,children:s.jsx(F,{className:"w-full",children:s.jsx(G,{type:"submit",disabled:!g,className:x.btn,onClick:r,children:t("Create")})})}),s.jsx($,{message:p})]}),s.jsx(M,{title:t("Confirm"),description:`${t("Add branch ")} "${i.values.name}"`,open:g&&l,onClose:u,onSave:i.onSubmit(_)})]})})})};function oe(e){var t,a,n,l,u,r;return{id:e.id.trim(),name:(t=e.name)==null?void 0:t.toString().trim(),shortName:(a=e.shortName)==null?void 0:a.toString().trim(),address:(n=e.address)==null?void 0:n.toString().trim(),phone:W((l=e.phone)==null?void 0:l.toString().trim()),email:(u=e.email)==null?void 0:u.toString().trim(),chainId:(r=e.chainId)==null?void 0:r.toString().trim()}}const le="_inputContainer_r8mgx_1",de="_input_r8mgx_1",me="_classNameBox_r8mgx_6",ce="_radioContainer_r8mgx_13",ue="_btn_r8mgx_41",j={inputContainer:le,input:de,classNameBox:me,radioContainer:ce,btn:ue},pe=({branch:e,updateBranch:t})=>{const a=A(),{chainOptions:n}=k(),[l,{close:u,open:r}]=O(!1),[p,N]=m.useState(),[i]=m.useState({id:(e==null?void 0:e.id)||"",name:(e==null?void 0:e.name)||"",shortName:(e==null?void 0:e.shortName)||"",address:(e==null?void 0:e.address)||"",phone:(e==null?void 0:e.phone)||"",email:(e==null?void 0:e.email)||"",chainId:(e==null?void 0:e.chainId)||""}),d=R({initialValues:i,transformValues:he}),g=m.useCallback(c=>{const S=c.phone!==(e==null?void 0:e.phone);return{name:c.name?null:a("Please enter name"),address:c.address?null:a("Please enter address"),phone:S&&!L(c.phone)?a("Please enter phone"):null,email:c.email?null:a("Please enter email"),chainId:c.chainId?null:a("Please select chain")}},[e==null?void 0:e.phone,a]),_=b(d,g,i),h=m.useCallback(c=>{N(void 0);const S=t(c);S?d.reset():N(S)},[t,d]);return s.jsx(s.Fragment,{children:s.jsxs("form",{onSubmit:d.onSubmit(r),children:[s.jsxs(E,{gap:10,px:10,mt:10,children:[s.jsxs("div",{className:j.inputContainer,children:[s.jsxs(o,{children:[a("Name"),":"]}),s.jsx(C,{className:j.input,withAsterisk:!0,placeholder:a("Name"),...d.getInputProps("name")})]}),s.jsxs("div",{className:j.inputContainer,children:[s.jsxs(o,{children:[a("Short Name"),":"]}),s.jsx(C,{className:j.input,withAsterisk:!0,placeholder:a("Short Name"),...d.getInputProps("shortName")})]}),s.jsxs("div",{className:j.inputContainer,children:[s.jsxs(o,{children:[a("Phone Number"),":"]}),s.jsx(T,{className:j.input,placeholder:a("Phone Number"),value:d.values.phone,onChangeValue:c=>d.setFieldValue("phone",c)})]}),s.jsxs("div",{className:j.inputContainer,children:[s.jsxs(o,{children:[a("Email"),":"]}),s.jsx(C,{className:j.input,withAsterisk:!0,placeholder:a("Email"),...d.getInputProps("email")})]}),s.jsxs("div",{className:j.inputContainer,children:[s.jsxs(o,{children:[a("Address"),":"]}),s.jsx(C,{className:j.input,withAsterisk:!0,placeholder:a("Address"),...d.getInputProps("address")})]}),s.jsxs(I,{className:j.inputContainer,children:[s.jsxs(o,{children:[a("Select chains"),":"]}),s.jsx(D,{disabled:!0,placeholder:a("Select chains"),options:n,className:j.input,value:d.values.chainId,onChange:c=>d.setValues({chainId:c})})]}),s.jsx("div",{className:j.inputContainer,children:s.jsx(F,{className:"w-full",children:s.jsx(G,{type:"submit",disabled:!_,className:j.btn,onClick:r,children:a("Save")})})}),s.jsx($,{message:p})]}),s.jsx(M,{title:a("Confirm"),description:`${a("Add branch ")} "${d.values.name}"`,open:_&&l,onClose:u,onSave:d.onSubmit(h)})]})})};function he(e){var t,a,n,l,u;return{id:e.id.trim(),name:(t=e.name)==null?void 0:t.toString().trim(),shortName:(a=e.shortName)==null?void 0:a.toString().trim(),address:(n=e.address)==null?void 0:n.toString().trim(),phone:W(e.phone.toString().trim()),email:(l=e.email)==null?void 0:l.toString().trim(),chainId:(u=e.chainId)==null?void 0:u.toString().trim()}}const xe="_container_f6gj5_1",je="_tableWrapper_f6gj5_7",Ne="_header_f6gj5_11",fe="_item_f6gj5_18",Ce="_label_f6gj5_29",ge="_itemDetail_f6gj5_33",f={container:xe,tableWrapper:je,header:Ne,item:fe,label:Ce,itemDetail:ge},_e=({branches:e,updateBranch:t,deleteBranch:a})=>{const n=A(),{defaultChainId:l,defaultBranchId:u}=k(),[r,p]=m.useState({branchId:u,chainId:l}),{close:N,opened:i,record:d,toggleEditModal:g}=q(),_=m.useMemo(()=>{var P;const w=((P=r.keyword)==null?void 0:P.toLocaleLowerCase())||"";return e.filter(B=>{var V;return r!=null&&r.chainId&&!r.chainId.includes(B.chainId)?!1:w?(((V=B==null?void 0:B.name)==null?void 0:V.toLocaleLowerCase())||"").includes(w):!0})},[e,r]),h=m.useMemo(()=>s.jsx(s.Fragment,{children:Se(_,a,g,n)}),[a,n,g,_]),c=m.useMemo(H,[]),S=m.useCallback(async w=>{const P=await t(w);return N(),P},[N,t]);return s.jsxs(z,{withBorder:!0,shadow:"md",w:"100%",children:[s.jsx(o,{fz:16,fw:"bold",pb:5,className:"bdr-b",children:n("Branches List")}),s.jsx(Y,{filter:r,setFilter:p,keys:["CHAIN_OPTIONS"]}),s.jsx(X,{headers:c,dataLength:e.length,rows:h,headerClassName:Z(f.header,f.item),tableWrapperClassName:f.tableWrapper}),s.jsxs(Q,{opened:i,onClose:N,title:n("Edit Branch"),centered:!0,size:"lg",classNames:{title:"font-bold"},children:[s.jsx("div",{className:"bdr-t"}),s.jsx(pe,{updateBranch:S,branch:d})]})]})},H=e=>[{style:{flex:2},label:"Name",value:e?s.jsxs(o,{children:[" ",e.name||"-"]}):""},{style:{flex:2},label:"Short Name",value:e?s.jsxs(o,{children:[" ",e.shortName||"-"]}):""},{style:{flex:1},label:"Phone",value:s.jsx(o,{children:K(e==null?void 0:e.phone)||"-"})},{style:{flex:2},label:"Email",value:e?s.jsxs(o,{children:[" ",e.email||"-"]}):""},{style:{flex:2},label:"Address",value:e?s.jsxs(o,{children:[" ",e.address||"-"]}):""}];function Se(e,t,a,n){return e&&e.map((l,u)=>s.jsxs(I,{className:f.item,children:[H(l).map(({label:r,style:p,value:N},i)=>s.jsxs(I,{className:f.itemDetail,style:p,children:[s.jsx(o,{className:f.label,children:n(r||"")}),N]},i)),s.jsxs(I,{className:f.itemDetail,children:[s.jsx(o,{className:f.label}),s.jsx(J,{title:n("Confirm"),description:`${n("Delete branch")} "${l.name}"`,onDelete:()=>t(l.id||""),onEdit:()=>a(l)})]})]},u))}const Je=()=>{const[e,t]=m.useState([]),{loadMetaData:a}=k(),n=m.useCallback((p=!1)=>{Ie(p).then(t),a()},[a]);m.useEffect(()=>{n()},[n]);const l=m.useCallback(async p=>we(p,n),[n]),u=m.useCallback(p=>Pe(p,n),[n]),r=m.useCallback(p=>Be(p,n),[n]);return s.jsxs(E,{gap:10,bg:"gray.1",w:"100%",h:"100%",p:10,children:[s.jsx(re,{addBranch:l}),s.jsx(_e,{branches:e,updateBranch:u,deleteBranch:r})]})};async function Ie(e=!1){const t=await v({action:"get-branches",params:{},options:{forceReload:e}});return(t==null?void 0:t.branches)||[]}async function we(e,t){return await v({action:"add-branch",params:e}).catch(()=>{y.error("Failed to add branch",e)}),t(!0),""}async function Pe(e,t){return await v({action:"update-branch",params:e}).catch(()=>{y.error("Failed to update branch",e)}),t(!0),""}async function Be(e,t){await v({action:"delete-branch",params:{id:e}}).catch(()=>{y.error("Failed to delete branch",{id:e})}),t(!0)}export{Je as default};
